% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/localscore.R
\name{local_score}
\alias{local_score}
\title{Apply the local score method to a vector of p-values}
\usage{
local_score(p, xi = 2)
}
\arguments{
\item{p}{Numeric vector of raw p-values (must be in \eqn{[0, 1]}).}

\item{xi}{Integer tuning parameter (1, 2, 3, or 4). Controls the p-value
threshold for positive contribution: only \eqn{p < 10^{-\xi}} markers
receive a positive score \eqn{X_m = -\log_{10}(p) - \xi > 0}.}
}
\value{
A \code{data.frame} with one row per marker and four columns:
\describe{
\item{\code{score}}{Per-marker score \eqn{X_m = -\log_{10}(p_m) - \xi}.}
\item{\code{lindley_score}}{Lindley process value \eqn{h_m \ge 0}.}
\item{\code{lindley_thresh}}{Genome-wide threshold (same value in every row),
computed by \code{lindley_thresh()}.}
\item{\code{lindley_window}}{Integer window label from \code{windows()}: consecutive
markers above the threshold share the same label (1, 2, 3, ...);
markers below the threshold are \code{NA}.}
}
}
\description{
The main entry point for local score analysis. Transforms raw p-values into
per-marker scores, computes the Lindley process, and attaches the
genome-wide significance threshold.
}
\examples{
set.seed(42)
p = c(runif(20, 0.1, 1), runif(5, 1e-5, 1e-4), runif(20, 0.1, 1))
result = local_score(p, xi = 2)
head(result)
}
