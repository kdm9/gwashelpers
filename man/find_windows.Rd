% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/localscore.R
\name{find_windows}
\alias{find_windows}
\title{Label consecutive runs of TRUE as distinct genomic windows}
\usage{
find_windows(state)
}
\arguments{
\item{state}{Logical vector. Typically the result of
\code{result$lindley_score > result$lindley_thresh} from \code{local_score()}.}
}
\value{
Integer vector of the same length as \code{state}. Each maximal run of
consecutive \code{TRUE} values is labeled with a unique positive integer
(1, 2, 3, ...). Positions where \code{state} is \code{FALSE} are set to \code{NA}.
}
\description{
Given a logical vector (typically \code{lindley_score > lindley_thresh}), assigns
consecutive runs of \code{TRUE} values a unique integer label. Useful for
enumerating distinct association peaks detected by the local score.
}
\details{
Each contiguous block of \code{TRUE} positions corresponds to a genomic excursion
interval - the span of markers within a single association peak. The integer
labels allow downstream grouping (e.g., \code{split()} or \code{dplyr::group_by()})
to extract and summarize each peak separately.
}
\examples{
state = c(FALSE, TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE)
find_windows(state)
# [1] NA  1  1 NA  2 NA  3  3
}
