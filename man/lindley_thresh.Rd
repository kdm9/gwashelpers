% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/localscore.R
\name{lindley_thresh}
\alias{lindley_thresh}
\title{Compute the local score significance threshold}
\usage{
lindley_thresh(pval, xi = 2, alpha = 0.05)
}
\arguments{
\item{pval}{Numeric vector of raw p-values (values in \eqn{[0, 1]}).
Used to compute both the number of markers \eqn{M = \text{length}(pval)}
and the lag-1 autocorrelation \eqn{\rho} via \code{autocor()}.}

\item{xi}{Integer tuning parameter; must be 1, 2, 3, or 4. Controls the
p-value cut-off: only markers with \eqn{p < 10^{-\xi}} contribute
positively to the Lindley process. Must match the \code{xi} used when computing
scores with \code{lindley_p()}.}

\item{alpha}{Numeric family-wise type-I error rate (default 0.05). The
threshold \eqn{t} satisfies \eqn{P(H_M > t) \le \alpha} under the null.}
}
\value{
Numeric threshold value, or \code{NULL} (with a message) if \code{xi} is not
in \eqn{\{1, 2, 3, 4\}}.
}
\description{
Returns the genome-wide significance threshold for the local score (Lindley
process maximum) using the Gumbel extreme-value approximation of
Fariello et al. (2017), Equation 4.
}
\details{
The Gumbel location and scale parameters are approximated as polynomials in
\eqn{\rho} (Fariello et al. 2017, Supplementary Information):

\deqn{a_{M,\rho} = \log(M) + c_3\rho^3 + c_2\rho^2 + c_1\rho + c_0}
\deqn{b_{M,\rho} = d_2\rho^2 + d_1\rho + d_0}

Polynomial coefficients (rows = polynomial term, columns = \eqn{\xi}):\tabular{lllll}{
   Term \tab \eqn{\xi=1} \tab \eqn{\xi=2} \tab \eqn{\xi=3} \tab \eqn{\xi=4} \cr
   \eqn{a}: \eqn{\rho^3} \tab -5.50 \tab 2.47 \tab 2.04 \tab 0.22 \cr
   \eqn{a}: \eqn{\rho^2} \tab 6.76 \tab -4.16 \tab -5.76 \tab -4.08 \cr
   \eqn{a}: \eqn{\rho} \tab -5.66 \tab -1.82 \tab 1.04 \tab 1.16 \cr
   \eqn{a}: intercept \tab -2.51 \tab -4.58 \tab -6.95 \tab -9.16 \cr
   \eqn{b}: \eqn{\rho^2} \tab -1.22 \tab 0.37 \tab 2.55 \tab 3.45 \cr
   \eqn{b}: \eqn{\rho} \tab 3.17 \tab 2.14 \tab -0.02 \tab -0.98 \cr
   \eqn{b}: intercept \tab -1.99 \tab -2.35 \tab -2.31 \tab -2.33 \cr
}


The threshold is (Eq. 4):
\deqn{t = \frac{\log(-\log(1-\alpha)) - a}{b}}

Note on parameterisation: the paper writes \eqn{\log(-\log(\alpha))} where
their \eqn{\alpha} denotes \eqn{1 - \text{FWER}}. This implementation uses
\eqn{\log(-\log(1-\alpha))} where \eqn{\alpha} is the FWER directly, which
is the conventional notation.
}
\examples{
set.seed(1)
p = runif(1000)
lindley_thresh(p, xi = 2, alpha = 0.05)
}
