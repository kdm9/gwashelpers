% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/localscore.R
\name{lindley_p}
\alias{lindley_p}
\title{Apply the local score method to a vector of p-values}
\usage{
lindley_p(p, xi = 2)
}
\arguments{
\item{p}{Numeric vector of raw p-values (must be in \eqn{[0, 1]}).}

\item{xi}{Integer tuning parameter (1, 2, 3, or 4). Controls the p-value
threshold for positive contribution: only \eqn{p < 10^{-\xi}} markers
receive a positive score \eqn{X_m = -\log_{10}(p) - \xi > 0}.}
}
\value{
A \code{data.frame} with one row per marker and three columns:
\describe{
\item{\code{score}}{Per-marker score \eqn{X_m = -\log_{10}(p_m) - \xi}.}
\item{\code{lindley_score}}{Lindley process value \eqn{h_m \ge 0}.}
\item{\code{lindley_thresh}}{Genome-wide threshold (same value in every row),
computed by \code{lindley_thresh()}.}
}
Markers where \code{lindley_score > lindley_thresh} are in a significant
association peak. Use \code{windows()} to label distinct peaks.
}
\description{
The main entry point for local score analysis. Transforms raw p-values into
per-marker scores, computes the Lindley process, and attaches the
genome-wide significance threshold.
}
\examples{
set.seed(42)
p = c(runif(20, 0.1, 1), runif(5, 1e-5, 1e-4), runif(20, 0.1, 1))
result = lindley_p(p, xi = 2)
head(result)
# Identify peak windows
result$window = windows(result$lindley_score > result$lindley_thresh)
}
